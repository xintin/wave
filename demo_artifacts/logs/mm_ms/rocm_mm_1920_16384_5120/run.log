[MM] Tuning (1920,5120) x (5120,16384) dtype=float16 on rocm
2025-10-01 12:22:39 [INFO] Logging directory: ./log/mm_ms/rocm_mm_1920_16384_5120/logs
2025-10-01 12:22:44 [INFO] [task_scheduler.cc:159] Initializing Task #0: "mm"
2025-10-01 12:22:44 [INFO] [task_scheduler.cc:320] 
 ID | Name |         FLOP | Weight | Speed (GFLOPS) | Latency (us) | Weighted Latency (us) | Trials | Done 
-----------------------------------------------------------------------------------------------------------
  0 |   mm | 322122547200 |      1 |            N/A |          N/A |                   N/A |      0 |      
-----------------------------------------------------------------------------------------------------------
Total trials: 0
Total latency (us): 0

2025-10-01 12:22:44 [INFO] [task_scheduler.cc:180] TaskScheduler picks Task #0: "mm"
2025-10-01 12:23:00 [INFO] [task_scheduler.cc:193] Sending 64 sample(s) to builder
error: <unknown>:0:0: stack frame size (245776) exceeds limit (131056) in function 'mm_kernel'
2025-10-01 12:23:32 [INFO] [task_scheduler.cc:195] Sending 64 sample(s) to runner
2025-10-01 12:31:55 [DEBUG] XGB iter   0: tr-p-rmse: 0.804759	tr-a-peak@32: 0.876127	tr-rmse: 0.476577	tr-rmse: 0.476577
2025-10-01 12:31:55 [DEBUG] XGB iter  25: tr-p-rmse: 0.092419	tr-a-peak@32: 1.000000	tr-rmse: 0.506392	tr-rmse: 0.506392
2025-10-01 12:31:55 [DEBUG] XGB iter  50: tr-p-rmse: 0.092419	tr-a-peak@32: 1.000000	tr-rmse: 0.506392	tr-rmse: 0.506392
2025-10-01 12:31:56 [DEBUG] XGB stopped. Best iteration: [11] tr-p-rmse:0.09242	tr-a-peak@32:1.00000	tr-rmse:0.50639	tr-rmse:0.50639 
2025-10-01 12:31:56 [INFO] [task_scheduler.cc:237] [Updated] Task #0: "mm"
2025-10-01 12:31:56 [INFO] [task_scheduler.cc:320] 
 ID | Name |         FLOP | Weight | Speed (GFLOPS) | Latency (us) | Weighted Latency (us) | Trials | Done 
-----------------------------------------------------------------------------------------------------------
  0 |   mm | 322122547200 |      1 |     73779.4415 |    4366.0204 |             4366.0204 |     64 |      
-----------------------------------------------------------------------------------------------------------
Total trials: 64
Total latency (us): 4366.02

2025-10-01 12:31:56 [INFO] [task_scheduler.cc:180] TaskScheduler picks Task #0: "mm"
2025-10-01 12:32:11 [INFO] [task_scheduler.cc:193] Sending 64 sample(s) to builder
2025-10-01 12:32:43 [INFO] [task_scheduler.cc:195] Sending 64 sample(s) to runner
2025-10-01 12:42:11 [DEBUG] XGB validation: p-rmse: 0.236928	a-peak@32: 0.990317
2025-10-01 12:42:11 [DEBUG] XGB iter   0: tr-p-rmse: 0.756316	tr-a-peak@32: 0.515590	tr-rmse: 0.434665	tr-rmse: 0.434665
2025-10-01 12:42:11 [DEBUG] XGB iter  25: tr-p-rmse: 0.078769	tr-a-peak@32: 1.000000	tr-rmse: 0.463568	tr-rmse: 0.463568
2025-10-01 12:42:11 [DEBUG] XGB iter  50: tr-p-rmse: 0.078769	tr-a-peak@32: 1.000000	tr-rmse: 0.463568	tr-rmse: 0.463568
2025-10-01 12:42:11 [DEBUG] XGB stopped. Best iteration: [11] tr-p-rmse:0.07877	tr-a-peak@32:1.00000	tr-rmse:0.46357	tr-rmse:0.46357 
2025-10-01 12:42:11 [INFO] [task_scheduler.cc:237] [Updated] Task #0: "mm"
2025-10-01 12:42:11 [INFO] [task_scheduler.cc:320] 
 ID | Name |         FLOP | Weight | Speed (GFLOPS) | Latency (us) | Weighted Latency (us) | Trials | Done 
-----------------------------------------------------------------------------------------------------------
  0 |   mm | 322122547200 |      1 |     88288.0065 |    3648.5425 |             3648.5425 |    128 |      
-----------------------------------------------------------------------------------------------------------
Total trials: 128
Total latency (us): 3648.54

2025-10-01 12:42:11 [INFO] [task_scheduler.cc:260] Task #0 has finished. Remaining task(s): 0
2025-10-01 12:42:11 [INFO] [task_scheduler.cc:320] 
 ID | Name |         FLOP | Weight | Speed (GFLOPS) | Latency (us) | Weighted Latency (us) | Trials | Done 
-----------------------------------------------------------------------------------------------------------
  0 |   mm | 322122547200 |      1 |     88288.0065 |    3648.5425 |             3648.5425 |    128 |    Y 
-----------------------------------------------------------------------------------------------------------
Total trials: 128
Total latency (us): 3648.54

[MS] Tuning Time (min): 19.58
 ID |                                        Name | Time (min) | Percentage 
----------------------------------------------------------------------------
    |                                       Total |    19.5617 |   100.0000 
  1 |                                SendToRunner |    17.8456 |    91.2274 
  2 |                               SendToBuilder |     1.0879 |     5.5615 
  3 |                   EvoSearch/Evolve/Mutation |     0.2888 |     1.4762 
  4 |              EvoSearch/SampleInitPopulation |     0.2051 |     1.0487 
  5 |             MeasureCallback/UpdateCostModel |     0.0111 |     0.0566 
  6 |                       EvoSearch/Evolve/Misc |     0.0102 |     0.0521 
  7 |     EvoSearch/Evolve/PredictNormalizedScore |     0.0046 |     0.0235 
  8 |              EvoSearch/PickBestFromDatabase |     0.0037 |     0.0189 
  9 |               MeasureCallback/AddToDatabase |     0.0009 |     0.0047 
 10 |         MeasureCallback/RemoveBuildArtifact |     0.0006 |     0.0033 
 11 |                 EvoSearch/PickWithEpsGreedy |     0.0003 |     0.0013 
 12 |                           JoinRunnerFutures |     0.0001 |     0.0003 
 13 |                              InitializeTask |     0.0000 |     0.0001 
 14 | EvoSearch/Evolve/Misc/CopyMeasuredWorkloads |     0.0000 |     0.0000 
----------------------------------------------------------------------------
[MM] (1920,5120) x (5120,16384) dtype=float16 -> median latency: 3.886 ms
TFLOPs: 82.90109837167493
=== Finished 1920x16384x5120 in 1188 seconds ===
